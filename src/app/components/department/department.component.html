<h2 class="mt-3">Departments</h2>

<div class="card shadow-sm mb-4">
  <div class="card-body">
    <app-department-form
      [editMode]="editMode"
      [selectedDepartment]="selectedDepartment"
      (formSubmit)="handleFormSubmit($event)"
      (formReset)="resetForm()">
    </app-department-form>
  </div>
</div>

<div class="d-flex gap-2 mb-3">

  <input type="text"
         class="form-control w-25"
         [(ngModel)]="searchTerm"
         placeholder="Search department">

  <button class="btn btn-primary" (click)="searchDepartment()">Search</button>
  <button class="btn btn-secondary" (click)="clearSearch()">Clear Search</button>

  <button class="btn btn-info text-white" (click)="sortByName()">
    Sort by Name {{ sortAsc ? '↑' : '↓' }}
  </button>

  <button class="btn btn-warning" (click)="clearSort()">Clear Sort</button>

</div>

<table class="table table-bordered table-hover text-center shadow-sm">
  <thead class="table-dark">
    <tr>
      <th>ID</th>
      <th>Department Name</th>
      <th>Actions</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let dep of paginatedDepartments">
      <td>{{ dep.depid }}</td>
      <td>{{ dep.depname }}</td>
      <td>
        <button class="btn btn-success btn-sm me-2" (click)="editDepartment(dep)">Edit</button>
        <button class="btn btn-danger btn-sm" (click)="deleteDepartment(dep.depid)">Delete</button>
      </td>
    </tr>

    <tr *ngIf="paginatedDepartments.length === 0">
      <td colspan="3" class="text-muted">No departments found</td>
    </tr>
  </tbody>
</table>

<div class="d-flex justify-content-center align-items-center gap-3 mt-3">

  <button class="btn btn-outline-primary"
          (click)="prevPage()"
          [disabled]="!paginationActive || currentPage === 1">
    Prev
  </button>

  <span>Page <strong>{{ paginationActive ? currentPage : 1 }}</strong> of {{ totalPages }}</span>

  <button class="btn btn-outline-primary"
          (click)="nextPage()"
          [disabled]="paginationActive ? currentPage === totalPages : (filteredDepartments.length <= pageSize)">
    Next
  </button>

  <button class="btn btn-secondary" (click)="showFullList()">
    Show Full List
  </button>

</div>
